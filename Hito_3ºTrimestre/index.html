<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Aplicación del Tiempo - Localidad</title>
  <link rel="stylesheet" href="estilo.css">
</head>
<body>

  <header>
    <h1 id="localidad">Aranjuez</h1>
    <img id="escudo" src="escudo_aranjuez.jpg" alt="Escudo de la localidad">
        <nav>
            <ul>
                <li><a href="index.html">Inicio</a></li>
                <li><a href="paginaprincipal.html">Informacion Sobre Aranjuez</a></li>
                <li><a href="informacionAranjuez.html">Informacion adicional de Aranjuez </a></li>
            </ul>
    </nav>
  </header>

<div class="container mt-5">
  <form id="dataSelectionForm">
      <div class="form-group">
          <label for="indexSelect">Selecciona una localidad:</label>
          <select class="form-control" id="indexSelect">
              <!-- Las opciones serán añadidas dinámicamente con JavaScript -->
          </select>
      </div>
  </form>
  <table id="weather-table" class="table">
      <thead>
          <tr>
              <th>Ciudad</th>
              <th>Provincia</th>
              <th>Descripción del Clima</th>
              <th>Temperatura Máxima (°C)</th>
              <th>Temperatura Mínima (°C)</th>
          </tr>
      </thead>
      <tbody id="weather-data">
      </tbody>
  </table>
</div>

<script>
  window.onload = function() {
      // Array con varias ciudades para el ejemplo
      const ciudades = [
          { id: 28079, nombre: "Aranjuez", provincia: "Madrid" },
          { id: 28005, nombre: "Madrid", provincia: "Madrid" },
          { id: 28023, nombre: "Alcalá de Henares", provincia: "Madrid" }
      ];

      const citySelect = document.getElementById('indexSelect');
      
      // Añadir las opciones de ciudad al select
      ciudades.forEach(ciudad => {
          const option = document.createElement('option');
          option.value = ciudad.id;  // Usamos el id del municipio como valor
          option.text = ciudad.nombre;  // Nombre de la ciudad como texto
          citySelect.appendChild(option);
      });

      // Evento de cambio para cargar los datos de la ciudad seleccionada
      citySelect.addEventListener('change', function() {
          const ciudadSeleccionada = ciudades.find(ciudad => ciudad.id === parseInt(this.value));

          if (ciudadSeleccionada) {
              fetch(`https://www.el-tiempo.net/api/json/v2/provincias/28/municipios/${ciudadSeleccionada.id}`)
                  .then(response => response.json())
                  .then(data => {
                      const weatherTable = document.getElementById('weather-table');
                      weatherTable.innerHTML = `
                          <thead>
                              <tr>
                                  <th>Ciudad</th>
                                  <th>Provincia</th>
                                  <th>Descripción del Clima</th>
                                  <th>Temperatura Actual (°C)</th>
                                  <th>Temperatura Máxima (°C)</th>
                                  <th>Temperatura Mínima (°C)</th>
                              </tr>
                          </thead>
                          <tbody>
                              <tr>
                                  <td>${ciudadSeleccionada.nombre}</td>
                                  <td>${ciudadSeleccionada.provincia}</td>
                                  <td>${data.stateSky.description}</td>
                                  <td>${data.temperatura_actual}°C</td>
                                  <td>${data.temperaturas.max}°C</td>
                                  <td>${data.temperaturas.min}°C</td>
                              </tr>
                          </tbody>
                      `;
                  })
                  .catch(error => console.error('Error al obtener los datos:', error));
          }
      });

      // Disparar el evento de cambio para cargar los datos iniciales (opcional)
      citySelect.dispatchEvent(new Event('change'));
  };
</script>

</body>
</html>

